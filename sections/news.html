<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>News | Femi Olamijulo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Recent milestones, awards, and updates from Femi Olamijulo's professional journey." />
  <!-- Favicon -->
  <link rel="icon" href="assets/logo.png" type="image/x-icon">
  
  <link rel="stylesheet" href="../assets/css/variables.css" />
  <link rel="stylesheet" href="../assets/css/layout.css" />
  <link rel="stylesheet" href="../assets/css/components.css" />
  <script src="../assets/js/mode-switcher.js" defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@300;400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <div id="particles-js" aria-hidden="true"></div>

  <header class="site-header scroll-reveal">
  <nav class="nav" aria-label="Main navigation">
    <div class="container flex-wrap">
      <h1 class="logo"><a href="#" aria-current="page">Femi Olamijulo</a></h1>
      
      <div class="nav-right">
        <ul class="navbar">
          <li><a href="../index.html">About</a></li>
          <li><a href="portfolio.html">Portfolio</a></li>
          <li><a href="news.html" class="active">News</a></li>
          <li><a href="../assets/Olufemi-Olamijulo-Resume.pdf" target="_blank" rel="noopener">CV</a></li>
        </ul>
        
        <!-- Enhanced Dark Mode Toggle -->
        <button id="mode-toggle" aria-label="Toggle dark mode" class="header-mode-toggle">
          <span class="light-icon" aria-hidden="true">â˜€ï¸</span>
          <span class="dark-icon" aria-hidden="true">ğŸŒ™</span>
          <span class="mode-tooltip"></span> 
        </button>
      </div>
    </div>
  </nav>
</header>

  <main class="page container scroll-reveal">
    <h1 class="header-name">Latest News</h1>

    <div class="filter-bar" role="toolbar" aria-label="News filter options">
      <button class="filter-button active" data-tag="all" aria-pressed="true">All</button>
      <button class="filter-button" data-tag="everett" aria-pressed="false">ğŸ—ï¸ Everett</button>
      <button class="filter-button" data-tag="award" aria-pressed="false">ğŸ† Awards</button>
      <button class="filter-button" data-tag="storytelling" aria-pressed="false">ğŸ§­ Storytelling</button>
    </div>

    <div class="news-timeline" id="news-container" role="list"></div>

    <div class="view-more-container">
      <button id="view-more-button" class="filter-button">View More</button>
    </div>


    <div class="no-news" aria-live="polite">No news items match these filters. Try another category.</div>
  </main>

  <footer class="site-footer scroll-reveal">
    <div class="container">
      <small id="last-updated"></small>
      <small class="block">Â© Femi Olamijulo â€¢ <a href="https://github.com/femiolamijulo">GitHub</a> â€¢ <a href="https://nexuseng.org">nexuseng.org</a></small>
    </div>
  </footer>
  <script src="../assets/js/featured-news.js" defer></script>

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script src="../assets/js/particles-config.js" defer></script>
  <script src="../assets/js/mode-switcher.js" defer></script>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const updated = document.getElementById("last-updated");
    if (updated) {
      updated.innerHTML = `<b>Last Updated:</b> ${new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}`;
    }

    const newsContainer = document.getElementById('news-container');

    // Inject all news items dynamically
    if (typeof allNewsItems !== 'undefined' && newsContainer) {
      allNewsItems.forEach(item => {
        const article = document.createElement('article');
        article.className = 'news-item visible';
        article.setAttribute('data-tags', item.tags.join(' '));
        article.setAttribute('role', 'listitem');

        article.innerHTML = `
          <img src="${item.img}" alt="${item.alt}" loading="lazy" width="300" height="200">
          <div class="news-content">
            <h3><a href="${item.url}" target="_blank" rel="noopener">${item.title}</a></h3>
            <p>${item.description}<br><em>Source: ${item.source}</em></p>
          </div>
        `;
        newsContainer.appendChild(article);
      });
    }

    // Scroll reveal animation
    const revealElements = document.querySelectorAll('.scroll-reveal');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('revealed');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });
    revealElements.forEach(el => observer.observe(el));

    // Filtering + batching
    const filterButtons = document.querySelectorAll('.filter-button[data-tag]');
    const newsItems = document.querySelectorAll('.news-item');
    const noNews = document.querySelector('.no-news');
    const viewMoreButton = document.getElementById('view-more-button');
    const ITEMS_PER_BATCH = 3;

    function updateVisibility() {
      let visibleCount = 0;
      let shown = 0;

      newsItems.forEach(item => {
        if (item.classList.contains('visible')) {
          visibleCount++;
          if (shown < ITEMS_PER_BATCH) {
            item.style.display = '';
            shown++;
          } else {
            item.style.display = 'none';
          }
          item.removeAttribute('hidden');
        } else {
          item.setAttribute('hidden', 'true');
          item.style.display = 'none';
        }
      });

      noNews.classList.toggle('visible', visibleCount === 0);
      viewMoreButton.style.display = (visibleCount > ITEMS_PER_BATCH) ? 'inline-block' : 'none';
    }

    function revealNextBatch() {
      let shown = 0;
      newsItems.forEach(item => {
        if (item.classList.contains('visible') && item.style.display === 'none') {
          item.style.display = '';
          shown++;
          if (shown >= ITEMS_PER_BATCH) return;
        }
      });

      const remaining = Array.from(newsItems).filter(item => item.classList.contains('visible') && item.style.display === 'none');
      viewMoreButton.style.display = remaining.length > 0 ? 'inline-block' : 'none';
    }

    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const tag = button.dataset.tag;
        filterButtons.forEach(btn => {
          btn.classList.remove('active');
          btn.setAttribute('aria-pressed', 'false');
        });
        button.classList.add('active');
        button.setAttribute('aria-pressed', 'true');

        newsItems.forEach(item => {
          const tags = item.dataset.tags.toLowerCase().split(' ');
          if (tag === 'all' || tags.includes(tag)) {
            item.classList.add('visible');
          } else {
            item.classList.remove('visible');
          }
        });

        updateVisibility();
      });
    });

    viewMoreButton.addEventListener('click', revealNextBatch);

    // Initial state: 'all' active
    newsItems.forEach(item => item.classList.add('visible'));
    updateVisibility();
  });
  </script>
